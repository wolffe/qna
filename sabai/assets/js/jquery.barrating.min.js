(function(d){var h;("undefined"!==typeof window&&null!==window?window:global).BarRating=h=function(){function c(){var a=this,c=function(){var b=d("<div />",{"class":"br-widget"});a.$elem.find("option").each(function(){var e,c,f;if(e=d(this).val())c=d(this).text(),(f=d(this).data("html"))&&(c=f),e=d("<a />",{href:"#","data-rating-value":e,"data-rating-text":c}),c=d("<span />",{html:a.options.showValues?c:""}),b.append(e.append(c))});a.options.showSelectedRating&&b.append(d("<div />",{text:"","class":"br-current-rating"}));
a.options.reverse&&b.addClass("br-reverse");a.options.readonly&&b.addClass("br-readonly");return b},k=function(){return a.options.reverse?"nextAll":"prevAll"},m=function(b){a.$elem.find('option[value="'+b+'"]').prop("selected",!0);a.$elem.change()},g=function(b){b=b?b:a.$elem.data("barrating").currentRatingText;a.options.showSelectedRating&&a.$elem.parent().find(".br-current-rating").text(b)},l=function(b){b.find("a").removeClass("br-selected br-current");b.find('a[data-rating-value="'+a.$elem.data("barrating").currentRatingValue+
'"]').addClass("br-selected br-current")[k()]().addClass("br-selected")},h=function(b){b.on("click",function(e){var c=d(this),f;e.preventDefault();b.removeClass("br-active br-selected");c.addClass("br-selected")[k()]().addClass("br-selected");e=c.attr("data-rating-value");f=c.attr("data-rating-text");c.hasClass("br-current")&&a.$elem.data("barrating").deselectable?(c.removeClass("br-selected br-current")[k()]().removeClass("br-selected br-current"),f=e=""):(b.removeClass("br-current"),c.addClass("br-current"));
a.$elem.data("barrating").currentRatingValue=e;a.$elem.data("barrating").currentRatingText=f;m(e);g(f);a.options.onSelect.call(this,a.$elem.data("barrating").currentRatingValue,a.$elem.data("barrating").currentRatingText);return!1})},n=function(b){b.on({mouseenter:function(){var a=d(this);b.removeClass("br-active br-selected");a.addClass("br-active")[k()]().addClass("br-active");g(a.attr("data-rating-text"))}})},p=function(a,c){c.on({mouseleave:function(){a.removeClass("br-active");g();l(c)}})},q=
function(a){a.on("touchstart",function(a){a.preventDefault();a.stopPropagation();d(this).click()})},r=function(a){a.on("click",function(a){a.preventDefault()})};this.show=function(){var b,e;a.$elem.data("barrating")||(a.$elem.wrap(d("<div />",{"class":a.options.wrapperClass?a.options.wrapperClass:""})),b=a.options.initialRating?d('option[value="'+a.options.initialRating+'"]',a.$elem):d("option:selected",a.$elem),a.$elem.data("barrating",{userOptions:a.options,currentRatingValue:b.val(),currentRatingText:b.data("html")?
b.data("html"):b.text(),originalRatingValue:b.val(),originalRatingText:b.data("html")?b.data("html"):b.text()}),a.$elem.data("barrating").deselectable=a.$elem.find("option:first").val()?!1:!0,b=c(),b.insertAfter(a.$elem),l(b),g(),e=b.find("a"),a.options.fastClicks&&q(e),a.options.readonly?r(e):(h(e),n(e),p(e,b)),a.$elem.hide())};this.set=function(a){this.$elem.find('option[value="'+a+'"]').val()&&(this.$elem.data("barrating").currentRatingValue=a,this.$elem.data("barrating").currentRatingText=this.$elem.find('option[value="'+
a+'"]').text(),m(this.$elem.data("barrating").currentRatingValue),g(this.$elem.data("barrating").currentRatingText),l(this.$widget))};this.clear=function(){this.$elem.data("barrating").currentRatingValue=this.$elem.data("barrating").originalRatingValue;this.$elem.data("barrating").currentRatingText=this.$elem.data("barrating").originalRatingText;m(this.$elem.data("barrating").currentRatingValue);g(this.$elem.data("barrating").currentRatingText);l(this.$widget);this.$elem.data("barrating").userOptions.onClear.call(this,
this.$elem.data("barrating").currentRatingValue,this.$elem.data("barrating").currentRatingText)};this.destroy=function(){var b=this.$elem.data("barrating").currentRatingValue,c=this.$elem.data("barrating").currentRatingText,d=this.$elem.data("barrating").userOptions;this.$widget.off().remove();a.$elem.removeData("barrating");a.$elem.unwrap();this.$elem.show();d.onDestroy.call(this,b,c)}}c.prototype.init=function(a,c){this.$elem=d(c);return this.options=d.extend({},d.fn.barrating.defaults,a)};return c}();
d.fn.barrating=function(c,a){return this.each(function(){var f=new h;d(this).is("select")||d.error("Sorry, this plugin only works with select fields.");if(f.hasOwnProperty(c)){f.init(a,this);if("show"===c)return f.show(a);if(f.$elem.data("barrating"))return f.$widget=d(this).next(".br-widget"),f[c](a)}else if("object"!==typeof c&&c)d.error("Method "+c+" does not exist on jQuery.barrating");else return a=c,f.init(a,this),f.show()})};return d.fn.barrating.defaults={initialRating:null,showValues:!1,
showSelectedRating:!0,reverse:!1,readonly:!1,fastClicks:!0,wrapperClass:"br-wrapper",onSelect:function(c,a){},onClear:function(c,a){},onDestroy:function(c,a){}}})(jQuery);
