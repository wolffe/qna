(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}}(function(f){var d=navigator.userAgent,c=/iphone/i.test(d),a=/chrome/i.test(d),b=/android/i.test(d),e;f.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:true,dataName:"rawMaskFn",placeholder:"_"};f.fn.extend({caret2:function(i,g){var h;if(this.length===0||this.is(":hidden")){return}if(typeof i=="number"){g=(typeof g==="number")?g:i;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(i,g)}else{if(this.createTextRange){h=this.createTextRange();h.collapse(true);h.moveEnd("character",g);h.moveStart("character",i);h.select()}}})}else{if(this[0].setSelectionRange){i=this[0].selectionStart;g=this[0].selectionEnd}else{if(document.selection&&document.selection.createRange){h=document.selection.createRange();i=0-h.duplicate().moveStart("character",-100000);g=i+h.text.length}}return{begin:i,end:g}}},unmask:function(){return this.trigger("unmask")},mask:function(q,j){var n,k,h,i,p,g,l,o;if(!q&&this.length>0){n=f(this[0]);var m=n.data(f.mask.dataName);return m?m():undefined}j=f.extend({autoclear:f.mask.autoclear,placeholder:f.mask.placeholder,completed:null},j);k=f.mask.definitions;h=[];i=l=q.length;p=null;f.each(q.split(""),function(r,s){if(s=="?"){l--;i=r}else{if(k[s]){h.push(new RegExp(k[s]));if(p===null){p=h.length-1}if(r<i){g=h.length-1}}else{h.push(null)}}});return this.trigger("unmask").each(function(){var F=f(this),w=f.map(q.split(""),function(J,I){if(J!="?"){return k[J]?E(I):J}}),B=w.join(""),H=F.val();function s(){if(!j.completed){return}for(var I=p;I<=g;I++){if(h[I]&&w[I]===E(I)){return}}j.completed.call(F)}function E(I){if(I<j.placeholder.length){return j.placeholder.charAt(I)}return j.placeholder.charAt(0)}function D(I){while(++I<l&&!h[I]){}return I}function y(I){while(--I>=0&&!h[I]){}return I}function v(L,I){var K,J;if(L<0){return}for(K=L,J=D(I);K<l;K++){if(h[K]){if(J<l&&h[K].test(w[J])){w[K]=w[J];w[J]=E(J)}else{break}J=D(J)}}C();F.caret2(Math.max(p,L))}function r(M){var K,L,I,J;for(K=M,L=E(M);K<l;K++){if(h[K]){I=D(K);J=w[K];w[K]=L;if(I<l&&h[I].test(J)){L=J}else{break}}}}function A(K){var J=F.val();var L=F.caret2();if(J.length<o.length){u(true);while(L.begin>0&&!h[L.begin-1]){L.begin--}if(L.begin===0){while(L.begin<p&&!h[L.begin]){L.begin++}}F.caret2(L.begin,L.begin)}else{var I=u(true);while(L.begin<l&&!h[L.begin]){L.begin++}F.caret2(L.begin,L.begin)}s()}function x(I){u();if(F.val()!=H){F.change()}}function z(L){if(F.prop("readonly")){return}var J=L.which||L.keyCode,M,K,I;o=F.val();if(J===8||J===46||(c&&J===127)){M=F.caret2();K=M.begin;I=M.end;if(I-K===0){K=J!==46?y(K):(I=D(K-1));I=J===46?D(I):I}t(K,I);v(K,I-1);L.preventDefault()}else{if(J===13){x.call(this,L)}else{if(J===27){F.val(H);F.caret2(0,u());L.preventDefault()}}}}function G(M){if(F.prop("readonly")){return}var I=M.which||M.keyCode,O=F.caret2(),L,N,K;if(M.ctrlKey||M.altKey||M.metaKey||I<32){return}else{if(I&&I!==13){if(O.end-O.begin!==0){t(O.begin,O.end);v(O.begin,O.end-1)}L=D(O.begin-1);if(L<l){N=String.fromCharCode(I);if(h[L].test(N)){r(L);w[L]=N;C();K=D(L);if(b){var J=function(){f.proxy(f.fn.caret2,F,K)()};setTimeout(J,0)}else{F.caret2(K)}if(O.begin<=g){s()}}}M.preventDefault()}}}function t(K,I){var J;for(J=K;J<I&&J<l;J++){if(h[J]){w[J]=E(J)}}}function C(){F.val(w.join(""))}function u(J){var N=F.val(),M=-1,I,L,K;for(I=0,K=0;I<l;I++){if(h[I]){w[I]=E(I);while(K++<N.length){L=N.charAt(K-1);if(h[I].test(L)){w[I]=L;M=I;break}}if(K>N.length){t(I+1,l);break}}else{if(w[I]===N.charAt(K)){K++}if(I<i){M=I}}}if(J){C()}else{if(M+1<i){if(j.autoclear||w.join("")===B){if(F.val()){F.val("")}t(0,l)}else{C()}}else{C();F.val(F.val().substring(0,M+1))}}return(i?I:p)}F.data(f.mask.dataName,function(){return f.map(w,function(J,I){return h[I]&&J!=E(I)?J:null}).join("")});F.one("unmask",function(){F.off(".mask").removeData(f.mask.dataName)}).on("focus.mask",function(){if(F.prop("readonly")){return}clearTimeout(e);var I;H=F.val();I=u();e=setTimeout(function(){if(F.get(0)!==document.activeElement){return}C();if(I==q.replace("?","").length){F.caret2(0,I)}else{F.caret2(I)}},10)}).on("blur.mask",x).on("keydown.mask",z).on("keypress.mask",G).on("input.mask paste.mask",function(){if(F.prop("readonly")){return}setTimeout(function(){var I=u(true);F.caret2(I);s()},0)});if(a&&b){F.off("input.mask").on("input.mask",A)}u()})}})}));